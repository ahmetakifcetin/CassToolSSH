#!/bin/bash

CYAN='\033[0;36m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
PURPLE='\033[0;35m'
NC='\033[0m'
BOLD='\033[1m'

CONFIG="/etc/casstool.conf"

show_banner() {
    echo -e "${CYAN}${BOLD}"
    cat << "EOF"
  ___   _   ___ ___ __  __   _   ___ ___  _____      __
 / __| /_\ / __/ __|  \/  | /_\ | _ \ _ \/ _ \ \    / /
| (__ / _ \\__ \__ \ |\/| |/ _ \|   /   / (_) \ \/\/ / 
 \___/_/ \_\___/___/_|  |_/_/ \_\_|_\_|_\\___/ \_/\_/  
EOF
    echo -e "${NC}"
    echo -e "${CYAN}Management Tool v2.0${NC}"
    echo ""
}

show_usage() {
    show_banner
    echo "KullanÄ±m: casstool <komut>"
    echo ""
    echo "Komutlar:"
    echo -e "  ${GREEN}enable${NC}      - casstool'u aktifleÅŸtir"
    echo -e "  ${GREEN}disable${NC}     - casstool'u devre dÄ±ÅŸÄ± bÄ±rak"
    echo -e "  ${GREEN}status${NC}      - Durum bilgisi gÃ¶ster"
    echo -e "  ${GREEN}config${NC}      - YapÄ±landÄ±rmayÄ± dÃ¼zenle"
    echo -e "  ${GREEN}customize${NC}   - Ä°nteraktif Ã¶zelleÅŸtirme"
    echo -e "  ${GREEN}test${NC}        - KarÅŸÄ±lama ekranÄ±nÄ± test et"
    echo -e "  ${GREEN}theme${NC}       - HÄ±zlÄ± tema deÄŸiÅŸtir (18 tema)"
    echo -e "  ${GREEN}style${NC}       - HÄ±zlÄ± stil deÄŸiÅŸtir (4 stil)"
    echo -e "  ${GREEN}themes${NC}      - TÃ¼m temalarÄ± listele"
    echo -e "  ${GREEN}uninstall${NC}   - casstool'u kaldÄ±r"
    echo ""
}

enable_motd() {
    if [ ! -f "$CONFIG" ]; then
        echo -e "${RED}Hata: YapÄ±landÄ±rma dosyasÄ± bulunamadÄ±${NC}"
        exit 1
    fi
    
    sed -i 's/MOTD_ENABLED="false"/MOTD_ENABLED="true"/' "$CONFIG"
    echo -e "${GREEN}âœ“ casstool aktifleÅŸtirildi${NC}"
    echo -e "${CYAN}Terminal giriÅŸlerinde karÅŸÄ±lama ekranÄ± gÃ¶sterilecek${NC}"
}

disable_motd() {
    if [ ! -f "$CONFIG" ]; then
        echo -e "${RED}Hata: YapÄ±landÄ±rma dosyasÄ± bulunamadÄ±${NC}"
        exit 1
    fi
    
    sed -i 's/MOTD_ENABLED="true"/MOTD_ENABLED="false"/' "$CONFIG"
    echo -e "${YELLOW}! casstool devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±${NC}"
    echo -e "${CYAN}Terminal giriÅŸlerinde karÅŸÄ±lama ekranÄ± gÃ¶sterilmeyecek${NC}"
}

show_status() {
    if [ ! -f "$CONFIG" ]; then
        echo -e "${RED}casstool kurulu deÄŸil${NC}"
        exit 1
    fi
    
    source "$CONFIG"
    
    show_banner
    echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    
    if [ "$MOTD_ENABLED" = "true" ]; then
        echo -e "Durum:          ${GREEN}â—${NC} Aktif"
    else
        echo -e "Durum:          ${RED}â—${NC} Devre DÄ±ÅŸÄ±"
    fi
    
    echo -e "Tema:           ${PURPLE}$COLOR_THEME${NC}"
    echo -e "Stil:           ${CYAN}$ASCII_STYLE${NC}"
    echo -e "Sistem AdÄ±:     ${CYAN}$SYSTEM_NAME${NC}"
    echo -e "Config:         ${CYAN}$CONFIG${NC}"
    echo ""
}

list_themes() {
    show_banner
    echo -e "${PURPLE}${BOLD}Gradient Temalar (Yeni!):${NC}"
    echo ""
    echo -e "  ${GREEN}1)${NC}  ice       â„ï¸  Cyan-blue gradient (default)"
    echo -e "  ${GREEN}2)${NC}  matrix    ğŸ’š Green matrix style"
    echo -e "  ${GREEN}3)${NC}  ocean     ğŸŒŠ Deep blue gradient"
    echo -e "  ${GREEN}4)${NC}  sunset    ğŸŒ… Orange-pink gradient"
    echo -e "  ${GREEN}5)${NC}  fire      ğŸ”¥ Red-orange gradient"
    echo -e "  ${GREEN}6)${NC}  neon      ğŸ’œ Purple-pink gradient"
    echo -e "  ${GREEN}7)${NC}  hacker    ğŸ‘¾ Dark green terminal"
    echo -e "  ${GREEN}8)${NC}  corporate ğŸ’¼ Gray-blue professional"
    echo -e "  ${GREEN}9)${NC}  gold      ğŸ† Yellow-gold gradient"
    echo -e "  ${GREEN}10)${NC} dracula   ğŸ§› Purple dark theme"
    echo -e "  ${GREEN}11)${NC} forest    ğŸŒ² Green nature gradient"
    echo -e "  ${GREEN}12)${NC} cosmic    ğŸŒŒ Deep purple-blue gradient"
    echo ""
    echo -e "${CYAN}${BOLD}Klasik Temalar:${NC}"
    echo ""
    echo -e "  ${GREEN}13)${NC} blue      ğŸ”µ Classic blue"
    echo -e "  ${GREEN}14)${NC} green     ğŸŸ¢ Classic green"
    echo -e "  ${GREEN}15)${NC} purple    ğŸŸ£ Classic purple"
    echo -e "  ${GREEN}16)${NC} cyan      ğŸ”· Classic cyan"
    echo -e "  ${GREEN}17)${NC} red       ğŸ”´ Classic red"
    echo -e "  ${GREEN}18)${NC} yellow    ğŸŸ¡ Classic yellow"
    echo ""
    echo -e "${YELLOW}Toplam: 18 tema Ã— 4 stil = 72 farklÄ± kombinasyon!${NC}"
    echo ""
}

change_theme() {
    show_banner
    echo -e "${PURPLE}${BOLD}Tema SeÃ§imi:${NC}"
    echo ""
    echo -e "${CYAN}Gradient Temalar:${NC}"
    echo "1) ice       2) matrix    3) ocean     4) sunset"
    echo "5) fire      6) neon      7) hacker    8) corporate"
    echo "9) gold     10) dracula  11) forest   12) cosmic"
    echo ""
    echo -e "${CYAN}Klasik Temalar:${NC}"
    echo "13) blue    14) green    15) purple   16) cyan"
    echo "17) red     18) yellow"
    echo ""
    read -p "Tema seÃ§in [1-18]: " choice
    
    case $choice in
        1) theme="ice" ;;
        2) theme="matrix" ;;
        3) theme="ocean" ;;
        4) theme="sunset" ;;
        5) theme="fire" ;;
        6) theme="neon" ;;
        7) theme="hacker" ;;
        8) theme="corporate" ;;
        9) theme="gold" ;;
        10) theme="dracula" ;;
        11) theme="forest" ;;
        12) theme="cosmic" ;;
        13) theme="blue" ;;
        14) theme="green" ;;
        15) theme="purple" ;;
        16) theme="cyan" ;;
        17) theme="red" ;;
        18) theme="yellow" ;;
        *) echo -e "${RED}GeÃ§ersiz seÃ§im${NC}"; exit 1 ;;
    esac
    
    sed -i "s/^COLOR_THEME=.*/COLOR_THEME=\"$theme\"/" "$CONFIG"
    echo ""
    echo -e "${GREEN}âœ“ Tema deÄŸiÅŸtirildi: ${PURPLE}$theme${NC}"
    echo ""
    echo -e "${YELLOW}Ã–nizleme iÃ§in: ${CYAN}casstool test${NC}"
    echo ""
}

change_style() {
    show_banner
    echo -e "${PURPLE}${BOLD}Stil SeÃ§imi:${NC}"
    echo ""
    echo "1) casstool  - Profesyonel (tam logo)"
    echo "2) minimal     - Minimal (kutu tasarÄ±m)"
    echo "3) retro       - Retro (klasik terminal)"
    echo "4) cyber       - Cyber (fÃ¼tÃ¼ristik)"
    echo ""
    read -p "Stil seÃ§in [1-4]: " choice
    
    case $choice in
        1) style="casstool" ;;
        2) style="minimal" ;;
        3) style="retro" ;;
        4) style="cyber" ;;
        *) echo -e "${RED}GeÃ§ersiz seÃ§im${NC}"; exit 1 ;;
    esac
    
    sed -i "s/^ASCII_STYLE=.*/ASCII_STYLE=\"$style\"/" "$CONFIG"
    echo ""
    echo -e "${GREEN}âœ“ Stil deÄŸiÅŸtirildi: ${PURPLE}$style${NC}"
    echo ""
    echo -e "${YELLOW}Ã–nizleme iÃ§in: ${CYAN}casstool test${NC}"
    echo ""
}

case "$1" in
    enable)
        enable_motd
        ;;
    disable)
        disable_motd
        ;;
    status)
        show_status
        ;;
    config)
        ${EDITOR:-nano} "$CONFIG"
        ;;
    customize)
        /opt/casstool/customize.sh
        ;;
    test)
        /opt/casstool/motd.sh
        ;;
    theme)
        change_theme
        ;;
    style)
        change_style
        ;;
    themes)
        list_themes
        ;;
    uninstall)
        /opt/casstool/uninstall.sh
        ;;
    *)
        show_usage
        exit 1
        ;;
esac
